{"tiddlers":{"$:/plugins/oeyoews/tiddlywiki-giscus/readme":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/readme","text":"<center>\n<$button class=\"get-started\">\n  <a style=\"text-decoration: none;\" target=\"_blank\"\n  href=\"https://neotw.netlify.app/main.html#%24%3A%2Fplugins%2Foeyoews%2Ftiddlywiki-giscus\">\n  Install Giscus {{$:/plugins/oeyoews/tiddlywiki-giscus/icon}}\n</a>\n</$button>\n\n<<nbtn \"$:/plugins/oeyoews/tiddlywiki-giscus/giscus-config\">>\n\n<$set name=\"repo\" value=\"$:/plugins/oeyoews/tiddlywiki-giscus/config\">\n  <$button class=\"get-started\" tooltip={{{ [<repo>get[repo]addsuffix[ discussions]] }}}>\n    <<giscusDiscussions>> Discussions\n  </$button>\n</$set>\n</center>\n\n<<<\n{{$:/plugins/oeyoews/tiddlywiki-giscus/icon}} A Commenting System Powered By Github Discussions. Let Visitors Leave Comments And Reactions On Your Site With Github! This Project Is Strongly Inspired By Utterances.\n<<<\n\n!! TODO\n\n* jump to comment directly\n<!-- * js macro and widget to get config tid data difference(load order) -->\n<!-- * add toggle on local -->\n\n<!---->\n<!-- * Split giscus config and add filter configurable -->\n<!-- * add jump to comment and how to toggle for toolbar [[example|https://tw5-github-comments.joseli.to/]] -->\n\n<!-- !function(){'use strict';exports.name='github-comments',exports.params=[{name:'current'}],exports.run=function(t){if($tw.browser){const e=document.getElementById('gh-comments');null!==e&&e.remove();const i=document.createElement('script');i.async=!0,i.src='https://utteranc.es/client.js',i.setAttribute('repo',$tw.wiki.getTiddlerText('$:/config/breakzplatform/github-comments/repo')),i.setAttribute('issue-term','['+$tw.wiki.getTiddlerText('$:/config/breakzplatform/github-comments/url')+'] '+t),i.setAttribute('theme',$tw.wiki.getTiddlerText('$:/config/breakzplatform/github-comments/theme')),i.setAttribute('crossorigin','anonymous');const n=document.createElement('div');n.id='gh-comments',n.appendChild(i),document.querySelector('div[data-tiddler-title=\"'+t+'\"] .gh-comments-wrapper').appendChild(n),$tw.utils.nextTick(function(){$tw.rootWidget.dispatchEvent({type:'github-comments-did-insert-element',target:n})})}}}(); -->\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/config":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/config","type":"text/vnd.tiddlywiki"},"$:/plugins/oeyoews/tiddlywiki-giscus/filter":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/filter","text":"[!is[system]]\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/giscus-config":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/giscus-config","text":"\\whitespace trim\n\n\\define tid() $:/plugins/oeyoews/tiddlywiki-giscus/config\n\\define tidFilter() $:/plugins/oeyoews/tiddlywiki-giscus/filter\n\nYou may have to save and reload the wiki to activate changes.\n\n* Install giscus for your github repo [[Install Giscus|https://github.com/apps/giscus/installations/new]]\n* [[get giscus parameter|https://giscus.app/zh-CN]]\n\n<table>\n  <tr>\n    <th align=\"left\">Github Repo Link:</th>\n    <td>\n      <$edit-text\n          tiddler=<<tid>>\n          field=\"repo\"\n          tag=\"input\"\n          placeholder=\"username/repo\"\n          default=\"\" />\n    </td>\n  </tr>\n  <tr>\n    <th align=\"left\">Github Reop Id:</th>\n    <td>\n      <$edit-text\n          tiddler=<<tid>>\n          field=\"repoId\"\n          tag=\"input\"\n          placeholder=\"TSJHFJDKHJExxx\"\n          default=\"\" />\n    </td>\n  </tr>\n  <tr>\n    <th align=\"left\">Github Repo Category Id:</th>\n    <td>\n      <$edit-text\n          tiddler=<<tid>>\n          field=\"categoryId\"\n          placeholder=\"DKSOFHGJVDKLXX\"\n          tag=\"input\"\n          default=\"\" />\n    </td>\n  </tr>\n\n  <tr>\n    <th align=\"left\">filter:</th>\n      <td>\n        <$edit-text\n            tiddler=<<tidFilter>>\n            placeholder=\"[!is[system]]\"\n            tag=\"input\"\n            default=\"\" />\n      </td>\n\n    <!-- not suitable on mobile(ios at least) -->\n    <td>\n      <$button>\n        Reset filter\n        <$action-deletetiddler $tiddler=<<tidFilter>>>/>\n      </$button>\n    </td>\n\n  </tr>\n\n</table>\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/icon":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/icon","text":"<svg stroke=\"\" fill=\"\" stroke-width=\"0\" t=\"1569682881658\" viewBox=\"0 0 1024 1024\" version=\"1.1\" height=\"1em\" width=\"1em\" xmlns=\"http://www.w3.org/2000/svg\"><defs></defs><path d=\"M573 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40zM293 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z\"></path><path d=\"M894 345c-48.1-66-115.3-110.1-189-130v0.1c-17.1-19-36.4-36.5-58-52.1-163.7-119-393.5-82.7-513 81-96.3 133-92.2 311.9 6 439l0.8 132.6c0 3.2 0.5 6.4 1.5 9.4 5.3 16.9 23.3 26.2 40.1 20.9L309 806c33.5 11.9 68.1 18.7 102.5 20.6l-0.5 0.4c89.1 64.9 205.9 84.4 313 49l127.1 41.4c3.2 1 6.5 1.6 9.9 1.6 17.7 0 32-14.3 32-32V753c88.1-119.6 90.4-284.9 1-408zM323 735l-12-5-99 31-1-104-8-9c-84.6-103.2-90.2-251.9-11-361 96.4-132.2 281.2-161.4 413-66 132.2 96.1 161.5 280.6 66 412-80.1 109.9-223.5 150.5-348 102z m505-17l-8 10 1 104-98-33-12 5c-56 20.8-115.7 22.5-171 7l-0.2-0.1C613.7 788.2 680.7 742.2 729 676c76.4-105.3 88.8-237.6 44.4-350.4l0.6 0.4c23 16.5 44.1 37.1 62 62 72.6 99.6 68.5 235.2-8 330z\"></path><path d=\"M433 421c-23.1 0-41 17.9-41 40s17.9 40 41 40c21.1 0 39-17.9 39-40s-17.9-40-39-40z\"></path></svg>\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/macro/discussions":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/macro/discussions","tags":"$:/tags/Macro","text":"\\whitespace trim\n\n\\define giscusDiscussions()\n<$set name=\"base-repo\" value=\"https://github.com/\">\n<$set name=\"target\" value=\"$:/plugins/oeyoews/tiddlywiki-giscus/config\">\n  <$button class=<<tv-config-toolbar-class>>>\n    <a href={{{ [<target>get[repo]addsuffix[/discussions]addprefix<base-repo>]}}} target=\"_blank\">\n\t\t{{$:/plugins/oeyoews/tiddlywiki-giscus/icon}}\n    </a>\n  </$button>\n</$set>\n</$set>\n\\end\n\n\\define giscusBadge()\n<$set name=\"base-repo\" value=\"https://github.com/\">\n<$set name=\"imgshield\" value=\"https://img.shields.io/github/discussions/\">\n<$set name=\"target\" value=\"$:/plugins/oeyoews/tiddlywiki-giscus/config\">\n  <$button class=<<tv-config-toolbar-class>>>\n    <a href={{{ [<target>get[repo]addsuffix[/discussions]addprefix<base-repo>]}}} target=\"_blank\">\n      <img alt=\"\" src={{{ [<target>get[repo]addprefix<imgshield>addsuffix[?style=for-the-badge]] }}} >\n    </a>\n  </$button>\n</$set>\n</$set>\n</$set>\n\\end\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/macro/get-started":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/macro/get-started","tags":"$:/tags/Macro","text":"<!-- general -->\n\\define nbtn(started-tid, class:\"get-started\", caption:\"Get Started\")\n  <$button class=$class$ tooltip=\"$caption$\">\n    $caption$\n    <!-- list filter todo -->\n    <$action-navigate $to={{{ $started-tid$ }}}/>\n  </$button>\n\\end\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/style":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/style","tags":"$:/tags/Stylesheet","text":"<!-- hide powered not work-->\n.gsc-left-header {\n    display: none !important;\n}\n\n#__next .text-sm {\n    font-size: .875rem;\n    line-height: 1.25rem;\n\t\tcolor: red !important;\n}\n\n<!-- btn style -->\n.get-started {\n\t\tdisplay: inline-block;\n    font-size: 16px;\n    background-color: rgb(97, 218, 251);\n    color: rgb(0, 0, 0);\n    padding: 10px 25px;\n    border-radius: 5px;\n    border-color: white;\n    white-space: nowrap;\n    transition: background-color 0.2s ease-out 0s;\n}\n\n.nbtn {\n\t\tdisplay: inline-block;\n    background-color: rgb(97, 218, 251);\n    color: rgb(0, 0, 0);\n    padding: 3px 8px;\n    white-space: nowrap;\n    border-radius: 5px;\n    transition: background-color 0.2s ease-out 0s;\n}\n\n.giscus-footer {\n    color: gray;\n    font-size: 14px;\n}\n\n.giscus-footer:hover {\n    color: black\n}\n"},"Comment Area":{"title":"Comment Area","text":"<!-- badges -->\n\n<center>\n  <h2>\n    ËøôÊòØ‰∏Ä‰∏™ÁïôË®ÄÂå∫ üêà <<giscusBadge>>\n  </h2>\n\nJump to github discussions <$set name=\"repo\" value=\"$:/plugins/oeyoews/tiddlywiki-giscus/config\">\n  <$button class=\"get-started\" tooltip={{{ [<repo>get[repo]addsuffix[ discussions]] }}}>\n    <<giscusDiscussions>>\n  </$button>\n</$set>\n\n</center>\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/giscus-pagecontrol":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/giscus-pagecontrol","caption":"giscus","description":"github giscus comments","tags":"$:/tags/PageControls","text":"\\whitespace trim\n\n\\define tid() Comment Area\n<$button tooltip=\"Message Here\" aria-label=\"Message Here\" class=<<tv-config-toolbar-class>> set=\"$:/state/oeyoews/github-giscus-comments\" setTo=<<tid>> >\n  {{$:/plugins/oeyoews/tiddlywiki-giscus/icon}}\n  <$action-navigate $to=<<tid>>/>\n<!-- giscus-sidebar-text: giscus -->\n<$list filter=\"[<tv-config-toolbar-text>match[yes]]\">\n  <span class=\"tc-btn-text\">\n    <$text text=\"giscus\"/>\n  </span>\n</$list>\n</$button>\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/viewtemplate":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/viewtemplate","tags":"$:/tags/ViewTemplate","text":"<div style=\"text-align: right\">\n  <!-- filter -->\n  <$list filter=\"[all[current]!is[system]!is[draft]subfilter{$:/plugins/oeyoews/tiddlywiki-giscus/filter}]\" variable=\"comment\">\n    <!-- lang -->\n    <$list filter=\"[[$:/language]get[text]removeprefix[$:/languages/]else[en-GB]]\" variable=\"lang\">\n        <$set name=\"stateTiddler\" value=\"$:/state/oeyoews/github-giscus-comments\">\n          <$reveal type=\"nomatch\" state=<<stateTiddler>> text=<<currentTiddler>>>\n              <$button class=\"tc-btn-invisible giscus-footer\" set=<<stateTiddler>> setTo=<<currentTiddler>> >\n                <!-- {{$:/core/images/down-arrow}} -->\n                {{$:/plugins/oeyoews/tiddlywiki-giscus/icon}}\n                <!-- en -->\n                <$list filter=\"[<lang>!search[zh]]\">\n                  Show Comments\n                </$list>\n                <!-- cn -->\n                <$list filter=\"[<lang>search[zh]]\">\n                  ÊòæÁ§∫ËØÑËÆ∫\n                </$list>\n              </$button>\n          </$reveal>\n          <$reveal type=\"match\" state=<<stateTiddler>> text=<<currentTiddler>>>\n                <$set name=\"repo\" value=\"$:/plugins/oeyoews/tiddlywiki-giscus/config\">\n                  <$button class=\"tc-btn-invisible\" tooltip={{{ [<repo>get[repo]addsuffix[ discussions]] }}}>\n                    <<giscusDiscussions>>\n                  </$button>\n                </$set>\n              <$button class=\"tc-btn-invisible giscus-footer\" set=<<stateTiddler>> setTo=\"\">\n                <!-- {{$:/core/images/up-arrow}} -->\n                <!-- {{$:/plugins/oeyoews/tiddlywiki-giscus/icon}} -->\n                <!-- en -->\n                <$list filter=\"[<lang>!search[zh]]\">\n                  Fold Comments\n                </$list>\n                <!-- cn -->\n                <$list filter=\"[<lang>search[zh]]\">\n                  Êî∂Ëµ∑ËØÑËÆ∫\n                </$list>\n              </$button>\n              <!-- load giscus -->\n              <$giscus id=<<comment>> lang=\"en\" theme=\"light\"/>\n          </$reveal>\n        </$set>\n     </$list>\n  </$list>\n</div>\n"},"/home/oeyoews/REPOS/neotw/dev/plugins/tiddlywiki-giscus/tiddlers/viewtoolbar.tid":{"title":"/home/oeyoews/REPOS/neotw/dev/plugins/tiddlywiki-giscus/tiddlers/viewtoolbar.tid","<!-- title":"$:/plugins/oeyoews/tiddlywiki-giscus/viewtoolbar -->","<!-- tags":"$:/tags/ViewToolbar -->","text":"\\whitespace trim\n\n<$list filter=\"[all[current]!is[draft]subfilter{$:/plugins/oeyoews/tiddlywiki-giscus/filter}]\" variable=\"comment\">\n\n\t<$button tooltip=\"View Giscus comments\" aria-label=\"giscus comments\" class=<<tv-config-toolbar-class>> set=\"$:/state/oeyoews/github-giscus-comments\" setTo=<<currentTiddler>> >\n\n\t\t<$list filter=\"[<tv-config-toolbar-icons>prefix[yes]]\">\n            {{$:/plugins/oeyoews/tiddlywiki-giscus/icon}}\n\t\t</$list>\n\n\t\t<$list filter=\"[<tv-config-toolbar-text>prefix[yes]]\">\n\t\t\t<span class=\"tc-btn-text\">\n\t\t\t\t<$text text=\" \"/>\n\t\t\t\t<$text text=\"view GitHub comments\"/>\n\t\t\t</span>\n\t\t</$list>\n\n\t</$button>\n\n</$list>\n"},"$:/plugins/oeyoews/tiddlywiki-giscus/widget":{"title":"$:/plugins/oeyoews/tiddlywiki-giscus/widget","module-type":"widget","type":"application/javascript","text":"(function() {\n    \"use strict\";\n\n    // tmp settings\n    // var usernameTiddler = \"neotw/username\";\n    // var username = $tw.wiki.getTiddlerText(usernameTiddler);\n    // if(username !== \"oeyoews\")\n    // {\n    //   alert(\"This giscus tiddlywiki plugin just for oeyoews build after version 0.7.0\")\n    //   console.error(\"This giscus tiddlywiki plugin just for oeyoews build after version 0.7.0\")\n    //   return;\n    // }\n\n    var Widget = require(\"$:/core/modules/widgets/widget.js\").widget;\n    var GiscusNodeWidget = function(parseTreeNode, options) {\n        this.initialise(parseTreeNode, options);\n    };\n\n    // ?? not suport repo-id filed, use repoId instead\n    var giscusConfigTiddler = \"$:/plugins/oeyoews/tiddlywiki-giscus/config\"\n    // console.log(giscusConfigTiddler)\n    var giscusConfigTiddlerGet = $tw.wiki.getTiddler(giscusConfigTiddler)\n    var config = giscusConfigTiddlerGet ? giscusConfigTiddlerGet.fields : {};\n    // console.log(config)\n\n    // debug\n    // console.log(config.repo)\n    // console.log(config.repoId)\n    // console.log(config.categoryId)\n\n    <!-- var repo = \"oeyoews/neotw\"; -->\n    <!-- var repoId = \"R_kgDOH5A5OA\"; -->\n    <!-- var categoryId = \"DIC_kwDOH5A5OM4CRFEE\"; -->\n\n    GiscusNodeWidget.prototype = new Widget();\n    GiscusNodeWidget.prototype.render = function(parent, nextSibling) {\n        this.parentDomNode = parent;\n        this.computeAttributes();\n        this.execute();\n        var id = this.getAttribute(\"id\", \"\");\n        var lang = this.getAttribute(\"lang\", \"en\");\n        var theme = this.getAttribute(\"theme\", \"light\");\n        if (id === '') return;\n        var scriptNode = this.document.createElement('script');\n        scriptNode.setAttribute(\"src\", \"https://giscus.app/client.js\");\n\n        scriptNode.setAttribute(\"data-repo\", config.repo);\n        scriptNode.setAttribute(\"data-repo-id\", config.repoId);\n        scriptNode.setAttribute(\"data-category\", \"General\");\n        scriptNode.setAttribute(\"data-category-id\", config.categoryId);\n\n        scriptNode.setAttribute(\"data-mapping\", \"specific\");\n        scriptNode.setAttribute(\"data-term\", id);\n        scriptNode.setAttribute(\"data-reactions-enabled\", \"1\");\n        scriptNode.setAttribute(\"data-emit-metadata\", \"0\");\n        scriptNode.setAttribute(\"data-input-position\", \"top\");\n        scriptNode.setAttribute(\"data-loading\", \"lazy\");\n        scriptNode.setAttribute(\"data-theme\", theme);\n        scriptNode.setAttribute(\"data-lang\", lang);\n        scriptNode.setAttribute(\"crossorigin\", \"anonymous\");\n        scriptNode.setAttribute(\"async\", \"true\");\n        // Clear other comment nodes' giscus class\n        var commentNodes = this.document.querySelectorAll('.giscus');\n        for (var i = 0, len = commentNodes.length; i < len; i++) {\n            commentNodes[i].classList.remove('giscus');\n        }\n        // Find or create\n      var commentNode = this.document.querySelector('.oeyoews-giscus[tiddler-title=\"' + id.replace('\"', '\\\\\"') + '\"]');\n      if (!commentNode) {\n        commentNode = this.document.createElement('div');\n        commentNode.setAttribute('class', 'giscus oeyoews-giscus');\n        commentNode.setAttribute('tiddler-title', id);\n        parent.insertBefore(commentNode, nextSibling);\n        this.domNodes.push(commentNode);\n      }\n        parent.insertBefore(scriptNode, nextSibling);\n        this.domNodes.push(scriptNode);\n    };\n    GiscusNodeWidget.prototype.execute = function() {};\n    GiscusNodeWidget.prototype.refresh = function() {\n        var changedAttributes = this.computeAttributes();\n        if (Object.keys(changedAttributes).length > 0) {\n            this.refreshSelf();\n            return true;\n        } else {\n            return false;\n        }\n    };\n    exports.giscus = GiscusNodeWidget;\n})();\n"}}}